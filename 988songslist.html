<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1280, initial-scale=1.0">
  <title>Playlist 988 FM</title>
  <style>
    body {
      margin: 0;
      background-color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: "Microsoft YaHei", Arial, sans-serif;
      color: #ddd;
    }

    .screen {
      width: 1280px;
      height: 520px;
      background-color: #111;
      border: 4px solid #777;
      border-radius: 16px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 25px rgba(0,0,0,0.6);
      padding: 20px;
    }

    .logo {
      position: absolute;
      top: 10px;
      left: 10px;
      width: 150px;
    }

    .title {
      position: absolute;
      top: 45px;
      right: 50px;
      font-size: 24px;
      color: #ccc;
      font-weight: bold;
      letter-spacing: 1px;
    }

    table {
      position: absolute;
      top: 110px;
      left: 20px;
      width: 1240px;
      border-collapse: collapse;
      font-size: 15px;
    }

    th, td {
      text-align: left;
      padding: 8px 12px;
      border-bottom: 1px solid #444;
    }

    th {
      color: #aaa;
      font-weight: normal;
      font-size: 18px;
    }

    tr:hover td {
      background-color: rgba(255,255,255,0.05);
    }

    .song {
      color: #eee;
    }
  </style>
</head>
<body>
  <div class="screen">
    <img src="https://raw.githubusercontent.com/SGolden58/svg/main/Logo/988.png" class="logo" alt="988">
    <div class="title">Song List</div>
    <table id="playlistTable">
      <tr><th>已播歌曲</th></tr>
      <tr><td>加载中… Loading latest songs…</td></tr>
    </table>
  </div>

  <script>
async function updatePlaylist() {
  try {
    const proxy = "https://api.allorigins.win/get?url=";
    const url = "https://sgolden58.github.io/radio/988songslist.xml";
    const res = await fetch(proxy + encodeURIComponent(url));
    const data = await res.json();
    const html = data.contents;

    const temp = document.createElement("div");
    temp.innerHTML = html;

    // Find "已播歌曲" section
    const playedSection = Array.from(temp.querySelectorAll("h3, h4, div, p"))
      .filter(el => el.innerText.includes("已播歌曲"))
      .map(el => el.nextElementSibling)
      .filter(Boolean)[0];

    let playlist = [];
    if (playedSection) {
      playlist = Array.from(playedSection.querySelectorAll("li, div, span"))
        .map(el => el.innerText.trim())
        .filter(t => t)
        .slice(0, 10); // latest 10 songs
    }

    const table = document.getElementById("playlistTable");
    table.innerHTML = `<tr><th>已播歌曲</th></tr>`;

    if (playlist.length === 0) {
      table.innerHTML += `<tr><td>未找到播放列表 / No songs found</td></tr>`;
    } else {
      playlist.forEach(song => {
        table.innerHTML += `<tr><td class="song">${song}</td></tr>`;
      });
    }
  } catch (e) {
    document.getElementById("playlistTable").innerHTML =
      `<tr><td>无法加载播放列表 / Unable to load playlist</td></tr>`;
    console.error(e);
  }
}

// Initial update + auto-refresh every 60s
updatePlaylist();
setInterval(updatePlaylist, 60000);
  </script>
</body>
</html>
